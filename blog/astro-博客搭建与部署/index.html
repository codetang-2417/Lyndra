<!DOCTYPE html><html lang="zh-cn"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.png"><meta name="generator" content="Astro v5.7.13"><!-- Canonical URL --><link rel="canonical" href="https://www.hysling.top/blog/astro-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2"><link rel="alternate" type="application/rss+xml" title="Lyndra's Blog" href="/rss.xml"><!-- Primary Meta Tags --><meta name="title" content="Astro 博客搭建与部署 - Lyndra's Blog"><meta name="description" content="素处以默"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://www.hysling.top/blog/astro-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2"><meta property="og:title" content="Astro 博客搭建与部署 - Lyndra's Blog"><meta property="og:description" content="素处以默"><meta property="og:image" content="https://www.hysling.top/blog/astro-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2"><!-- <meta property="og:image:alt" content={site.description}/> --><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://www.hysling.top/blog/astro-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2"><meta property="twitter:title" content="Astro 博客搭建与部署 - Lyndra's Blog"><meta property="twitter:description" content="素处以默"><meta property="twitter:image" content="https://www.hysling.top/blog/astro-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="sitemap" href="/sitemap-0.xml"><title>Astro 博客搭建与部署 - Lyndra&#39;s Blog</title><script src="/toggle-theme.js"></script><script async type="text/javascript" src="/load-mathjax.js"></script><script async type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/mermaid/10.9.0/mermaid.min.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><link rel="stylesheet" href="/_astro/BlogPost.BUYUBhIy.css">
<link rel="stylesheet" href="/_astro/WalineComment.XaQ6XQsx.css">
<link rel="stylesheet" href="/_astro/about.gIe6_up2.css">
<link rel="stylesheet" href="/_astro/_slug_.DYqrg3Zi.css">
<style>#donate-item-img{filter:grayscale(1)}#donate-item-img:hover{filter:blur(0px);cursor:pointer}.esa-sponsor{position:relative;width:100%;margin:40px 0}.esa-sponsor .qrshow{position:absolute;width:200px;height:200px;cursor:pointer;left:calc(50% - 100px);top:-170px;z-index:999;display:none;box-shadow:0 1px 15px #1b1f2326,0 0 1px #6a737d59}
.post-title[data-astro-cid-6t6zfk7k]:hover{outline:0;color:#cc7a00;text-shadow:1px 1px 1px #ffd147}.toc_container[data-astro-cid-6t6zfk7k]{overflow-y:scroll;scrollbar-width:none;-ms-overflow-style:none}.toc_container[data-astro-cid-6t6zfk7k]::-webkit-scrollbar{width:0;height:0}.toc_container[data-astro-cid-6t6zfk7k] a[data-astro-cid-6t6zfk7k]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}
</style></head><body class="bg-skin-secondary"> <header class="fixed top-0 w-full bg-skin-fill text-skin-base z-10"> <div class="flex items-center justify-between container"> <div class="block xl:hidden"> <button type="button" id="menu-icon" class="header-btn" title="Menu"> <i class="ri-menu-fill"></i> </button> <button type="button" id="menu-icon-close" class="header-btn hidden" title="Menu"> <i class="ri-close-fill"></i> </button> <script type="module">let n=document.getElementById("menu-icon"),t=document.getElementById("menu-icon-close"),l=document.getElementById("mobile-menu"),e=document.getElementById("aside-btn"),i=document.getElementById("aside-close-btn"),s=document.getElementById("personal-info");n.addEventListener("click",()=>{e&&e.classList.contains("hidden")&&d([e,i,s]),d([n,t,l])});t.addEventListener("click",()=>{d([n,t,l])});function d(o){o.forEach(c=>{c.classList.toggle("hidden")})}</script> </div> <a class="text-2xl p-4" href="/">Lyndra&#39;s Blog</a> <div class="flex items-center"> <div class="hidden xl:block"> <div class="flex items-center space-x-5 pr-4"> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/blog/1" target="_self" class="header-link-active hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-draft-line" data-astro-cid-eimmu3lg></i> 博客  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/feed/1" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-lightbulb-flash-line" data-astro-cid-eimmu3lg></i> 动态  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/archive/1" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-archive-line" data-astro-cid-eimmu3lg></i> 归档  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/message" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-chat-1-line" data-astro-cid-eimmu3lg></i> 留言  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="/search" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-search-line" data-astro-cid-eimmu3lg></i> 搜索  </a>  </div> <div class="box relative h-10 w-auto flex items-center" data-astro-cid-eimmu3lg> <a href="javascript:void(0);" target="_self" class="hover:header-link-hover" data-astro-cid-eimmu3lg> <i class="ri-more-fill" data-astro-cid-eimmu3lg></i> 更多 <i class="ri-arrow-down-s-line" data-astro-cid-eimmu3lg></i> </a> <div class="dropdown cursor-pointer border rounded bg-skin-fill p-4" data-astro-cid-eimmu3lg> <ul class="space-y-4 w-28" data-astro-cid-eimmu3lg> <li class="text-center hover:text-skin-active select-none" data-astro-cid-eimmu3lg> <i class="ri-information-line" data-astro-cid-eimmu3lg></i> <a target="_self" href="/about" data-astro-cid-eimmu3lg>关于本站</a> </li><li class="text-center hover:text-skin-active select-none" data-astro-cid-eimmu3lg> <i class="ri-user-5-line" data-astro-cid-eimmu3lg></i> <a target="_self" href="/friends" data-astro-cid-eimmu3lg>友情链接</a> </li> </ul> </div> </div>  </div> </div> <button type="button" id="theme-btn" class="header-btn" title="Toggles light & dark" aria-label="auto" aria-live="polite"> <i id="moon-icon" class="ri-sun-line"></i> <i id="sun-icon" class="ri-moon-line"></i> </button> <div class="block xl:hidden"> <button type="button" id="aside-btn" class="header-btn" title="Open Aside Bar" aria-label="auto" aria-live="polite"> <i class="ri-user-line"></i> </button> <button type="button" id="aside-close-btn" class="header-btn hidden" title="Close Aside Bar" aria-label="auto" aria-live="polite"> <i class="ri-close-fill"></i> </button> <div id="blog-aside" class="absolute top-16 bg-skin-fill right-0 blog-aside hidden"></div> <script type="module">let n=document.getElementById("aside-btn"),t=document.getElementById("aside-close-btn"),e=document.getElementById("menu-icon"),i=document.getElementById("menu-icon-close"),s=document.getElementById("mobile-menu"),l=document.getElementById("personal-info");n.addEventListener("click",()=>{e&&e.classList.contains("hidden")&&d([e,i,s]),d([n,t,l])});t.addEventListener("click",()=>{d([t,l,n])});function d(o){o.forEach(c=>{c.classList.toggle("hidden")})}</script> </div> </div> </div> <div id="mobile-menu" class="hidden text-center overflow-y-auto pb-8" style="height: calc(100vh - 64px)"> <div class="py-2"> <a class=" hover:text-skin-active" href="/blog/1"> <i class="ri-draft-line"></i> <span>博客</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/feed/1"> <i class="ri-lightbulb-flash-line"></i> <span>动态</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/archive/1"> <i class="ri-archive-line"></i> <span>归档</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/message"> <i class="ri-chat-1-line"></i> <span>留言</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="/search"> <i class="ri-search-line"></i> <span>搜索</span> </a>  <div class="space-y-4 text-sm">  </div> </div><div class="py-2"> <a class=" hover:text-skin-active" href="javascript:void(0);"> <i class="ri-more-fill"></i> <span>更多</span> </a> <div class="divider-horizontal"></div> <div class="space-y-4 text-sm"> <a class="block hover:text-skin-active" href="/about"> <i class="ri-information-line"></i> <span>关于本站</span> </a><a class="block hover:text-skin-active" href="/friends"> <i class="ri-user-5-line"></i> <span>友情链接</span> </a> </div> </div> </div> <div id="personal-info" class="hidden break-all overflow-y-auto pb-8" style="height: calc(100vh - 64px)"> <img class="avatar my-4 mx-auto" src="/avatar.svg" alt="avatar"> <div class="mb-2 text-center">本来无一物，何处惹尘埃</div> <div class="flex items-center justify-center flex-wrap"> <a title="github" href="https://github.com/codetang-2417" target="_blank"> <i class="ri-github-fill text-2xl mr-2 cursor-pointer"></i> </a><a title="rss" href target="_blank"> <i class="ri-rss-fill text-2xl mr-2 cursor-pointer"></i> </a> </div> <div class="divider-horizontal-mini"></div> <div class="text-center"> <div> <i class="ri-folder-3-line menu-icon"></i>分类 </div> <div class="my-2 break-all truncate"> <a class="hover:text-skin-active" title="工具教程 (16)" href="/category/工具教程"> 工具教程 (16) </a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active" title="专业知识 (4)" href="/category/专业知识"> 专业知识 (4) </a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active" title="编程开发 (8)" href="/category/编程开发"> 编程开发 (8) </a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active" title="系统维护 (21)" href="/category/系统维护"> 系统维护 (21) </a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active" title="网络安全 (7)" href="/category/网络安全"> 网络安全 (7) </a> </div> <div class="divider-horizontal-mini"></div>
          <div class="text-center"> <i class="ri-price-tag-3-line menu-icon"></i> 标签 </div> <div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="AI" href="/tags/AI">AI (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="iPhone" href="/tags/iPhone">iPhone (2)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Performance" href="/tags/Performance">Performance (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Linux" href="/tags/Linux">Linux (17)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Manjaro" href="/tags/Manjaro">Manjaro (8)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Bash" href="/tags/Bash">Bash (2)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Server" href="/tags/Server">Server (8)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Network" href="/tags/Network">Network (4)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Hardware" href="/tags/Hardware">Hardware (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Astro" href="/tags/Astro">Astro (2)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Github" href="/tags/Github">Github (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Blog" href="/tags/Blog">Blog (3)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Siyuan" href="/tags/Siyuan">Siyuan (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Archlinux" href="/tags/Archlinux">Archlinux (2)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Shell" href="/tags/Shell">Shell (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Downgrade" href="/tags/Downgrade">Downgrade (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Cursor" href="/tags/Cursor">Cursor (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Git" href="/tags/Git">Git (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Ubuntu" href="/tags/Ubuntu">Ubuntu (6)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Markdown" href="/tags/Markdown">Markdown (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Hugo" href="/tags/Hugo">Hugo (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Github pages" href="/tags/Github pages">Github pages (1)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Algorithm" href="/tags/Algorithm">Algorithm (3)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Docker" href="/tags/Docker">Docker (5)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="VPS" href="/tags/VPS">VPS (3)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="Proxy" href="/tags/Proxy">Proxy (4)</a> </div><div class="my-2 break-all truncate"> <a class="hover:text-skin-active my-2" title="QEMU" href="/tags/QEMU">QEMU (3)</a> </div> </div> </div> </header> <main class="container p-4  pt-20 text-skin-base min-h-full pb-32 relative" id="app"> <div class="grid grid-cols-4 gap-8"> <div class="col-span-4 xl:col-span-3 space-y-4 first:space-y-2"> <button class="flex items-center text-md cursor-pointer hover:text-skin-active outline-none" style="background-color: inherit;" onclick="history.back()"> <i class="ri-arrow-left-line mr-2"></i> <span>返回</span> </button>  <div> <div> <!-- title --> <h1 class="break-all text-2xl font-bold">Astro 博客搭建与部署</h1> <div class="flex flex-wrap items-center my-2 text-skin-dodge"> <!-- date --> <div class="mr-2"><i class="ri-calendar-2-fill mr-1"></i>2025-01-14</div> <!-- draft -->  <!-- category --> <a href="/category/工具教程" class="text-wrap break-all hover:text-skin-active mr-2"><i class="ri-folder-3-line mr-1"></i>工具教程</a> <!-- tag --> <a href="/tags/Astro" class="text-wrap break-all hover:text-skin-active mr-2"><i class="ri-hashtag mr-1"></i>Astro</a><a href="/tags/Github" class="text-wrap break-all hover:text-skin-active mr-2"><i class="ri-hashtag mr-1"></i>Github</a><a href="/tags/Blog" class="text-wrap break-all hover:text-skin-active mr-2"><i class="ri-hashtag mr-1"></i>Blog</a><a href="/tags/Siyuan" class="text-wrap break-all hover:text-skin-active mr-2"><i class="ri-hashtag mr-1"></i>Siyuan</a> <!-- update --> <!--{--> <!--  lastModified && (--> <!--    <div class="mr-2"><i class="ri-calendar-check-fill "></i>{t('post.lastUpdated')}:{lastModified}</div>--> <!--  )--> <!--}--> <!-- minutes --> <div class="mr-2 flex items-center"><i class="ri-hourglass-fill mr-1"></i>22分钟</div>
        <div class="mr-2 flex items-center"><i class="ri-quill-pen-line mr-1"></i>4387字</div> </div>  </div> <div class="divider-horizontal"></div> <article class="markdown-body"> <h1 id="astro-博客搭建与部署">Astro 博客搭建与部署</h1>
<p>　　基于 <a href="https://astro.build/">astro.build</a> 搭建博客。可部署在服务器、<a href="https://www.netlify.com/">www.netlify.com</a>、github pages。</p>
<p>　　在网上还看到有自动化工具：<a href="https://github.com/LaughingZhu/DevNow">DevNow</a>，基于 astro 一键式搭建博客，但主题无法自选。</p>
<p>　　本文还是以常规的方式，选择主题，按照主题的要求修改源码配置，最后通过 github 的 action 自动部署到 github pages。</p>
<p>　　<strong>本文在 Linux 下完成。</strong></p>
<h2 id="目标">目标</h2>
<ol>
<li>搭建过程尽可能简单，不需要太复杂的技术，太绚丽的界面。</li>
<li>无需购买服务器，托管在 github，但开启自定义域名，通过自己的域名访问。</li>
<li>博客功能：有阅读目录TOC、清晰的代码块展示、归档和搜索的功能。</li>
<li>更新内容要方便。</li>
</ol>
<h2 id="主题选择">主题选择</h2>
<p>　　自己设计主题和功能需要花费较多的时间，学习前端知识，学习astro。本文本着将博客当作一个工具来使用，而不是一个折腾、学习的项目的态度，尽可能的提供简洁的方案。</p>
<p>　　本文选择主题 <a href="https://astro-yi-nu.vercel.app/">Astro Theme Yi</a>，足够简洁，但不简单，需要的功能都有，能看得出来作者是按照自己的使用场景打造，作者自己的博客也确实就是基于这个主题建立的。相比之下，我之前基于 hugo 的 stack 主题功能上有一些简单，SEO不友好，还需要解决一些问题才能使用。</p>
<p>　　感谢作者的努力！</p>
<h2 id="域名注册">域名注册</h2>
<p>　　我希望拥有一个自己的域名，单独用作博客，或者是自己的一些服务。如果不想购买域名，则可以直接使用 github 的 page 服务，或者部署在 netlify 上。</p>
<p>　　我在 namesilo 上购买 top 域名，相比于 com 域名，会便宜很多。首年 1.88 美元，续费 4.88 美元。</p>
<p>　　购买后，按照 cloudflare 的域名DNS解析指南，在 cloudflare 托管域名，将 namesilo 的域名的域名服务器，替换为 cloudflare 的。这样才能在 cloudflare 中管理自己的域名。</p>
<h2 id="使用模板">使用模板</h2>
<p>　　可以在 astro 官方网站中找自己喜欢的模板。下面以 Astro-yi 为例。</p>
<h3 id="下载和配置">下载和配置</h3>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.r9qfg.css"><script type="module" src="/_astro/ec.dy9ns.js"></script><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#9ECBFF;--1:#032F62">git clone https://github.com/cirry/astro-yi.git</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="git clone https://github.com/cirry/astro-yi.git"><div></div></button></div></figure></div>
<p>　　参考：<a href="https://cirry.cn/blog/astro/config-and-write-skill/">Astro-Yi主题配置和写作技巧</a> 原作者提供的主题配置，对模板进行修改。</p>
<h3 id="本地小修改">本地小修改</h3>
<p>　　由于之前的 markdown 书写习惯是从二级标题开始，所以将 TOC 的标题改为从 H2 开始显示。</p>
<p>　　修改文件 src/components/Toc.astro</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span class="indent">  </span><span style="--0:#9ECBFF;--1:#032F62">tocbot.init({</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">2</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">tocSelector</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">".toc-container"</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">3</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">contentSelector</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">".markdown-body"</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">4</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#185f29">headingSelector</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">"h2,h3,h4"</span><span style="--0:#E1E4E8;--1:#24292E">,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">5</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">hasInnerContainers</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">true,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">6</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">headingsOffset</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">80,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">7</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">scrollSmoothOffset</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">-80,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">8</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">scrollSmoothDuration</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">200,</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">9</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#185f29">collapseDepth</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">4,</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">10</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">onClick</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">function (){</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">11</div></div><div class="code"><span class="indent">      </span><span style="--0:#9ECBFF;--1:#032F62">return false</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">12</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">},</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">13</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">}</span><span style="--0:#9ECBFF;--1:#032F62">);</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="  tocbot.init({    tocSelector: &#x22;.toc-container&#x22;,    contentSelector: &#x22;.markdown-body&#x22;,    headingSelector: &#x22;h2,h3,h4&#x22;,    hasInnerContainers: true,    headingsOffset: 80,    scrollSmoothOffset: -80,    scrollSmoothDuration: 200,    collapseDepth: 4,    onClick: function (){      return false    },  });"><div></div></button></div></figure></div>
<h3 id="构建">构建</h3>
<p>　　参考主题仓库的 readme，在终端中，运行下列命令。</p>
<p>　　通过 npm 安装需要的组件，并且预览网站。</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#9ECBFF;--1:#032F62">npm install -g pnpm</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">2</div></div><div class="code"><span style="--0:#9ECBFF;--1:#032F62">pnpm i</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">3</div></div><div class="code"><span style="--0:#9ECBFF;--1:#032F62">npm run dev</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#99A0A6;--1:#616972"># preview</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="npm install -g pnpmpnpm inpm run dev # preview"><div></div></button></div></figure></div>
<p>　　成功后，可在本地浏览器输入 <code>http://localhost:4321/</code>​ 预览</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250224154639-u8rnte7.png" data-alt="image">​</p>
<p>　　将博客文章写在 <code>src/content/blog</code>​ 文件夹中，在 <code>src/content/feed</code>​ 文件夹中编写想发布的动态内容。通过下列命令编译打包内容。</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#9ECBFF;--1:#032F62">npm run build</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#99A0A6;--1:#616972"># build</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="npm run build # build"><div></div></button></div></figure></div>
<p>　　打包完成后，在根目录中会生成一个 dist 文件夹。将 ‘dist’ 文件夹上传到 Web 服务器目录中，即可完成部署。对于 github 来说，可以使用 action 自动化实现打包部署的过程。</p>
<h3 id="action自动化部署">Action自动化部署</h3>
<p>　　参考：<a href="https://docs.astro.build/zh-cn/guides/deploy/github/#configure-a-github-action">部署你的 Astro 站点至 GitHub Pages</a></p>
<p>　　官方的教程是在源码仓库部署，而我的需求是将源码仓库设置为私有仓库，将 build 后的网站部署到另一个公开仓库。需要对官方的 action 脚本进行修改。</p>
<h4 id="生成-pat-和-actions-secrets">生成 PAT 和 Actions secrets</h4>
<p>　　由于是部署到另一个仓库，需要先获取 PAT，通过 PAT 提供另一个仓库的访问权限。可以参考：<a href="https://www.hysling.top/blog/%E5%9F%BA%E4%BA%8E-hugo-%E5%92%8C-github-pages%E6%90%AD%E5%BB%BAbolg/">Hugo搭建</a> 中的<code>使用 git 模板</code>​ 部分，生成 <code>经典 Tokens</code>​。需要注意，如果用细粒度令牌（Fine-grained Tokens）生成 PAT ，需要开启 <strong>Contents</strong> 的权限，否则在部署时会遇到权限错误。</p>
<p>　　然后在仓库设置中，把 PAT 添加到 Actions secrets。</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250227115347-6fek964.png" data-alt="image">​</p>
<h4 id="编写-deployyml">编写 deploy.yml</h4>
<p>　　在私有仓库，也就是源码仓库，新建 .github/workflows/deploy.yml ，并按照自己的仓库、分支名称，填写如下，其中 secrets.ASTRO_DEPLOY 就是生成的 PAT。</p>
<div class="expressive-code"><figure class="frame"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#85E89D;--1:#1E7734">name</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">Deploy to GitHub Pages</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">2</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">3</div></div><div class="code"><span style="--0:#79B8FF;--1:#005CC5">on</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">4</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 每次推送到 `main` 分支时触发这个"工作流程"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">5</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 如果你使用了别的分支名，请按需将 `main` 替换成你的分支名</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">6</div></div><div class="code"><span class="indent">  </span><span style="--0:#85E89D;--1:#1E7734">push</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">7</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#185f29">branches</span><span style="--0:#E1E4E8;--1:#24292E">: [ </span><span style="--0:#9ECBFF;--1:#032F62">main</span><span style="--0:#E1E4E8;--1:#24292E"> ]</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">8</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 允许你在 GitHub 上的 Actions 标签中手动触发此"工作流程"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">9</div></div><div class="code"><span class="indent">  </span><span style="--0:#85E89D;--1:#1E7734">workflow_dispatch</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">10</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">11</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972"># 允许 job 克隆 repo 并创建一个 page deployment</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">12</div></div><div class="code"><span style="--0:#85E89D;--1:#1E7734">permissions</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">13</div></div><div class="code"><span class="indent">  </span><span style="--0:#85E89D;--1:#1E7734">contents</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">read</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">14</div></div><div class="code"><span class="indent">  </span><span style="--0:#85E89D;--1:#1E7734">pages</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">write</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">15</div></div><div class="code"><span class="indent">  </span><span style="--0:#85E89D;--1:#1E7734">id-token</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">write</span></div></div><details class="ec-section"><summary><div class="ec-line"><div class="gutter"><div class="ln"></div></div><div class="code"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 16 16" width="16" height="16"><path d="m8.177.677 2.896 2.896a.25.25 0 0 1-.177.427H8.75v1.25a.75.75 0 0 1-1.5 0V4H5.104a.25.25 0 0 1-.177-.427L7.823.677a.25.25 0 0 1 .354 0ZM7.25 10.75a.75.75 0 0 1 1.5 0V12h2.146a.25.25 0 0 1 .177.427l-2.896 2.896a.25.25 0 0 1-.354 0l-2.896-2.896A.25.25 0 0 1 5.104 12H7.25v-1.25Zm-5-2a.75.75 0 0 0 0-1.5h-.5a.75.75 0 0 0 0 1.5h.5ZM6 8a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1 0-1.5h.5A.75.75 0 0 1 6 8Zm2.25.75a.75.75 0 0 0 0-1.5h-.5a.75.75 0 0 0 0 1.5h.5ZM12 8a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1 0-1.5h.5A.75.75 0 0 1 12 8Zm2.25.75a.75.75 0 0 0 0-1.5h-.5a.75.75 0 0 0 0 1.5h.5Z"></path></svg>24 collapsed lines</div></div></summary><div class="ec-line"><div class="gutter"><div class="ln">16</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">17</div></div><div class="code"><span style="--0:#85E89D;--1:#1E7734">jobs</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">18</div></div><div class="code"><span class="indent">  </span><span style="--0:#85E89D;--1:#1E7734">build</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">19</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">runs-on</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">ubuntu-latest</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">20</div></div><div class="code"><span class="indent">    </span><span style="--0:#85E89D;--1:#1E7734">steps</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">21</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">      </span></span><span style="--0:#E1E4E8;--1:#24292E">- </span><span style="--0:#85E89D;--1:#1E7734">name</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">Checkout your repository using git</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">22</div></div><div class="code"><span class="indent">        </span><span style="--0:#85E89D;--1:#1E7734">uses</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">actions/checkout@v4</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">23</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">      </span></span><span style="--0:#E1E4E8;--1:#24292E">- </span><span style="--0:#85E89D;--1:#1E7734">name</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">Install, build, and upload your site</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">24</div></div><div class="code"><span class="indent">        </span><span style="--0:#85E89D;--1:#1E7734">uses</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">withastro/action@v3</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">25</div></div><div class="code"><span class="indent">        </span><span style="--0:#85E89D;--1:#1E7734">with</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">26</div></div><div class="code"><span class="indent">          </span><span style="--0:#99A0A6;--1:#616972"># path: . # 存储库中 Astro 项目的根位置。（可选）</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">27</div></div><div class="code"><span class="indent">          </span><span style="--0:#99A0A6;--1:#616972"># node-version: 20 # 用于构建站点的特定 Node.js 版本，默认为 20。（可选）</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">28</div></div><div class="code"><span class="indent">          </span><span style="--0:#85E89D;--1:#185f29">package-manager</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">pnpm@latest</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#afb5b9;--1:#4d545b"># 指定使用 pnpm 8.x 版本</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">29</div></div><div class="code"><span class="indent">          </span><span style="--0:#99A0A6;--1:#616972"># package-manager: pnpm@latest # 或者使用最新版本的 pnpm</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">30</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">      </span></span><span style="--0:#E1E4E8;--1:#24292E">- </span><span style="--0:#85E89D;--1:#185f29">name</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">Deploy to GitHub Pages</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">31</div></div><div class="code"><span class="indent">        </span><span style="--0:#85E89D;--1:#185f29">id</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">deployment</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">32</div></div><div class="code"><span class="indent">        </span><span style="--0:#85E89D;--1:#185f29">uses</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">JamesIves/github-pages-deploy-action@v4</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#afb5b9;--1:#4d545b"># 一个自动发布github pages的action</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">33</div></div><div class="code"><span class="indent">        </span><span style="--0:#85E89D;--1:#185f29">with</span><span style="--0:#E1E4E8;--1:#24292E">:</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">34</div></div><div class="code"><span class="indent">            </span><span style="--0:#85E89D;--1:#185f29">repository-name</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">用户名/公开仓库名。例如：codegithub/codegithub.github.io</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">35</div></div><div class="code"><span class="indent">            </span><span style="--0:#85E89D;--1:#185f29">token</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">${{ secrets.ASTRO_DEPLOY }}</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">36</div></div><div class="code"><span class="indent">            </span><span style="--0:#85E89D;--1:#185f29">branch</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">main</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">37</div></div><div class="code"><span class="indent">            </span><span style="--0:#85E89D;--1:#185f29">folder</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#9ECBFF;--1:#032F62">dist</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">38</div></div><div class="code"><span class="indent">            </span><span style="--0:#85E89D;--1:#185f29">clean</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#79B8FF;--1:#004fa9">true</span></div></div><div class="ec-line highlight mark"><div class="gutter"><div class="ln">39</div></div><div class="code"><span class="indent">            </span><span style="--0:#85E89D;--1:#185f29">single-commit</span><span style="--0:#E1E4E8;--1:#24292E">: </span><span style="--0:#79B8FF;--1:#004fa9">true</span></div></div></details></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="name: Deploy to GitHub Pageson:  # 每次推送到 &#x60;main&#x60; 分支时触发这个&#x22;工作流程&#x22;  # 如果你使用了别的分支名，请按需将 &#x60;main&#x60; 替换成你的分支名  push:    branches: [ main ]  # 允许你在 GitHub 上的 Actions 标签中手动触发此&#x22;工作流程&#x22;  workflow_dispatch:# 允许 job 克隆 repo 并创建一个 page deploymentpermissions:  contents: read  pages: write  id-token: writejobs:  build:    runs-on: ubuntu-latest    steps:      - name: Checkout your repository using git        uses: actions/checkout@v4      - name: Install, build, and upload your site        uses: withastro/action@v3        with:          # path: . # 存储库中 Astro 项目的根位置。（可选）          # node-version: 20 # 用于构建站点的特定 Node.js 版本，默认为 20。（可选）          package-manager: pnpm@latest # 指定使用 pnpm 8.x 版本          # package-manager: pnpm@latest # 或者使用最新版本的 pnpm      - name: Deploy to GitHub Pages        id: deployment        uses: JamesIves/github-pages-deploy-action@v4 # 一个自动发布github pages的action        with:            repository-name: 用户名/公开仓库名。例如：codegithub/codegithub.github.io            token: ${{ secrets.ASTRO_DEPLOY }}            branch: main            folder: dist            clean: true            single-commit: true"><div></div></button></div></figure></div>
<h4 id="跳过-github-的-jekyll-流程">跳过 github 的 Jekyll 流程</h4>
<p>　　<a href="https://vrabe.tw/blog/note-about-deploying-astro-sites-to-github-pages/">在 GitHub Pages 部署 Astro 網站要注意的事情</a>、<a href="https://github.blog/news-insights/bypassing-jekyll-on-github-pages/">Bypassing Jekyll on GitHub Pages</a></p>
<p>　　astro 编译后，会将样式文件放在 <code>_astro</code>​ 文件夹下，但 github 如果在仓库中选择基于分支构建 Pages，则会自动采取 Jekyll 的方式构建 Pages。而 Jekyll 会跳过前缀是下划线的文件夹的处理，在访问博客时，该文件夹下的内容就无法访问。如果采取 action 作为构建 Pages 的方式，就不受影响，astro 官方就是采用 action 作为构建 Pages 的方式。</p>
<p>　　解决方式是在作为 pages 的仓库的根目录下创建一个名为  <strong>​<code>.nojekyll</code>​</strong>​ 空文件，这样会绕过 Jekyll 构建过程并直接部署内容。所以，在本文的场景中，需要在源码 astro 仓库的 public 文件夹创建  <strong>​<code>.nojekyll</code>​</strong>​ 空文件。这样部署到公开仓库后，公开仓库的根目录下就会有  <strong>​<code>.nojekyll</code>​</strong>​ 空文件。</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250227123417-0uesi3b.png" data-alt="image">​</p>
<h2 id="github添加自己域名">github添加自己域名</h2>
<p>　　由于不想购买服务器，不想让个人使用的服务和代理 VPS 混合在一起使用，可以将博客部署到 github pages，然后为 github pages 配置自己的域名，就可以通过自己的域名访问了。</p>
<h3 id="为-github-pages-启用自己的域名">为 github pages 启用自己的域名</h3>
<p>　　参考：<a href="https://docs.github.com/zh/pages/configuring-a-custom-domain-for-your-github-pages-site/verifying-your-custom-domain-for-github-pages">【官方】验证 GitHub Pages 的自定义域</a>、<a href="http://t.csdnimg.cn/0FNBP">【教程】Github Page 添加自定义域名</a>、<a href="https://juejin.cn/post/6895518085504040973">多项目部署为同一个GitHub Pages</a></p>
<p>　　官方教程有些晦涩，中文翻译不完整，例如 apex 域名（顶点域名），标题里面没翻译，正文里面又翻译了，导致我以为 apex 是 github 的配置。</p>
<h4 id="验证">验证</h4>
<p>　　先在 github 的设置中，添加自己的域名。</p>
<p>　　点击自己的头像，进入设置界面，选择 Pages，添加自己的域名。</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250222163618-ybk09zy.png" data-alt="image">​</p>
<p>　　然后会显示如下内容，意思是，你现在需要去自己的域名托管网站，为自己的域名添加一条包含 <strong>固定的名称和内容</strong> 的 TXT 类型的 DNS 解析记录。</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250222163920-tuioo83.png" data-alt="image">​</p>
<p>　　比如在 cloudflare 中，添加一条 TXT 的 DNS 解析记录</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250222164239-xtsgwhl.png" data-alt="image">​</p>
<p>　　添加完成后，稍等一会，点击 Verify，github 就会自动去验证。</p>
<h4 id="映射">映射</h4>
<p>　　先配置顶点域名，将顶点域名映射到 github pages 的站点 ip 地址。</p>
<p>　　官方文档中给出了 github pages 的 ipv4 和 ipv6 的所有 ip 地址，需要将顶点域名（也就是购买时获得的域名，没有任何子域名的。例如 your.top 和 <a href="http://www.your.top%EF%BC%8C%E5%89%8D%E8%80%85%E6%98%AF%E9%A1%B6%E7%82%B9%E5%9F%9F%E5%90%8D%EF%BC%8C%E5%90%8E%E8%80%85%E6%98%AF%E5%AD%90%E5%9F%9F%E5%90%8D%EF%BC%89%E8%A7%A3%E6%9E%90%E5%88%B0%E7%BB%99%E5%87%BA%E7%9A%84%E5%87%A0%E4%B8%AA">www.your.top，前者是顶点域名，后者是子域名）解析到给出的几个</a> ip 地址。一般来说，名称填入 @ 就表示顶点域名。</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250222172023-b428yyy.png" data-alt="image">​</p>
<p>　　然后配置子域名，配置子域名时，就不用解析到 ip 地址了，直接选择 CNAME 类型，将自己的子域名映射到 your_github_useranme_.github.io 即可。</p>
<p>　　配置完毕后如下（注意，如果是 cloudflare 配置，需要取消代理，即不点亮橙色云，否则无法强制开启 https）：</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250226150304-myypp98.png" data-alt="image">​</p>
<p>　　最后还需要在启用 github pages 的仓库（如果想在源码仓库开启 pages 也可以，需要将仓库权限改为 Public。否则，就需要新建一个 Public 仓库）的设置中，配置自己的域名。</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250222175326-02oh7ib.png" data-alt="image">​</p>
<h4 id="强制-https">强制 HTTPS</h4>
<p>　　参考：<a href="https://community.cloudflare.com/t/github-pages-keep-saying-it-cant-enforce-https/397570">Github pages keep saying it cant enforce https</a>、<a href="https://www.reddit.com/r/CloudFlare/comments/18vyd8c/unable_to_enforce_https_on_my_site/">Unable to enforce https on my site.</a></p>
<p>　　如果需要让自定义域名强制支持 https，则需要等 github 自动设置证书生效后，勾选 Enforce HTTPS。</p>
<p>　　注意，在 cloudflare 中，不能点亮小橙云，否则 github 不会自动申请证书。下图为关闭小橙云后，github 自动申请证书时的截图。</p>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250226150421-72hbxyt.png" data-alt="image">​</p>
<h2 id="撰写文章并更新">撰写文章并更新</h2>
<h3 id="思源笔记导出转换">思源笔记导出转换</h3>
<p>　　之前我的博客使用 hugo 搭建的，先在思源笔记上写文章，然后导出 md 压缩包，手动解压然后移动到对应的仓库中，并修改部分内容适配 hugo。</p>
<p>　　现在换到 astro，由于 astro 不支持相对路径引用图片，写了一个自动化转换思源的 md 压缩包到 astro 博客框架的脚本。这个脚本会自动解压缩、替换图片路径、将图片移动到 public/images 下、修改文件命名等。</p>
<p>　　脚本内容如下：</p>
<div class="expressive-code"><figure class="frame" style="--lnWidth:3ch"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">#!/usr/bin/env bash</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">2</div></div><div class="code"><span style="--0:#79B8FF;--1:#005CC5">set</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-eo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">pipefail</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">3</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">4</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972"># 颜色配置</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">5</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">RED</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">'\033[0;31m'</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">6</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">GREEN</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">'\033[0;32m'</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">7</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">'\033[1;33m'</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">8</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">'\033[0m'</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">9</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">10</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972"># 基础路径配置</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">11</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">BLOG_PATH</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"/home/ling/Desktop/blog/astro-yi"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">12</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">CONTENT_PATH</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$BLOG_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/src/content/blog"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">13</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">PUBLIC_IMAGES_PATH</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$BLOG_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/public/images"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">14</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">15</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972"># 命令配置：格式「命令名="描述::处理函数::选项声明"」</span></div></div><details class="ec-section"><summary><div class="ec-line"><div class="gutter"><div class="ln"></div></div><div class="code"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 16 16" width="16" height="16"><path d="m8.177.677 2.896 2.896a.25.25 0 0 1-.177.427H8.75v1.25a.75.75 0 0 1-1.5 0V4H5.104a.25.25 0 0 1-.177-.427L7.823.677a.25.25 0 0 1 .354 0ZM7.25 10.75a.75.75 0 0 1 1.5 0V12h2.146a.25.25 0 0 1 .177.427l-2.896 2.896a.25.25 0 0 1-.354 0l-2.896-2.896A.25.25 0 0 1 5.104 12H7.25v-1.25Zm-5-2a.75.75 0 0 0 0-1.5h-.5a.75.75 0 0 0 0 1.5h.5ZM6 8a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1 0-1.5h.5A.75.75 0 0 1 6 8Zm2.25.75a.75.75 0 0 0 0-1.5h-.5a.75.75 0 0 0 0 1.5h.5ZM12 8a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1 0-1.5h.5A.75.75 0 0 1 12 8Zm2.25.75a.75.75 0 0 0 0-1.5h-.5a.75.75 0 0 0 0 1.5h.5Z"></path></svg>353 collapsed lines</div></div></summary><div class="ec-line"><div class="gutter"><div class="ln">16</div></div><div class="code"><span style="--0:#F97583;--1:#BF3441">declare</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-A</span><span style="--0:#E1E4E8;--1:#24292E"> COMMAND_MAP</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">(</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">17</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#B392F0;--1:#6F42C1">"unzip"</span><span style="--0:#E1E4E8;--1:#24292E">]=</span><span style="--0:#9ECBFF;--1:#032F62">"解压思源笔记导出的md压缩包::handle_unzip::-f,--file:指定压缩包文件路径（必须）::-o,--output:输出目录（默认：与压缩包同名）"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">18</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#B392F0;--1:#6F42C1">"move-images"</span><span style="--0:#E1E4E8;--1:#24292E">]=</span><span style="--0:#9ECBFF;--1:#032F62">"移动图片文件到公共目录::handle_move_images::-d,--dir:指定包含assets的目录（必须）"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">19</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#B392F0;--1:#6F42C1">"update-references"</span><span style="--0:#E1E4E8;--1:#24292E">]=</span><span style="--0:#9ECBFF;--1:#032F62">"更新MD文件中的图片引用::handle_update_references::-f,--file:指定MD文件路径（必须）::-n,--name:文件夹名称（必须）"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">20</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#B392F0;--1:#6F42C1">"move-md"</span><span style="--0:#E1E4E8;--1:#24292E">]=</span><span style="--0:#9ECBFF;--1:#032F62">"移动MD文件到博客根目录::handle_move_md::-f,--file:指定MD文件路径（必须）"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">21</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[</span><span style="--0:#B392F0;--1:#6F42C1">"process-all"</span><span style="--0:#E1E4E8;--1:#24292E">]=</span><span style="--0:#9ECBFF;--1:#032F62">"执行完整处理流程::handle_process_all::-f,--file:指定压缩包文件路径（必须）::-d,--delete:处理完成后删除源压缩包（可选）"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">22</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">23</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">24</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972"># 错误处理函数</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">25</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">26</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">RED</span><span style="--0:#9ECBFF;--1:#032F62">}[错误]${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">>&#x26;2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">27</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">exit</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">28</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">29</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">30</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972"># 日志输出函数</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">31</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">32</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">GREEN</span><span style="--0:#9ECBFF;--1:#032F62">}[信息]${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">>&#x26;2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">33</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">34</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">35</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">log_warning</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">36</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}[警告]${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">>&#x26;2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">37</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">38</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">39</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">40</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">GREEN</span><span style="--0:#9ECBFF;--1:#032F62">}[成功]${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">>&#x26;2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">41</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">42</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">43</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">##############################################</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">44</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">#          通用的帮助信息生成函数            #</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">45</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">##############################################</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">46</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">47</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">show_command_help</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">48</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> cmd</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">49</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> info</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">COMMAND_MAP</span><span style="--0:#9ECBFF;--1:#032F62">[</span><span style="--0:#E1E4E8;--1:#24292E">$cmd</span><span style="--0:#9ECBFF;--1:#032F62">]}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">50</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">51</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 1) 把所有 "::" 替换成一个不会在脚本中出现的分隔符，比如 '|'</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">52</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">info</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">info</span><span style="--0:#F97583;--1:#BF3441">//::/</span><span style="--0:#9ECBFF;--1:#032F62">|}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">53</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">54</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 2) 这时才能安全地用 IFS='|' 来做分割</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">55</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> desc handler options_str</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">56</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">IFS</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"|"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">read</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-r</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">desc</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">handler</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">options_str</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$info</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">57</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">58</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}命令: ${</span><span style="--0:#E1E4E8;--1:#24292E">GREEN</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$cmd</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">59</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}描述: ${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$desc</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">60</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}选项:${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">61</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">62</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 3) 选项声明里可能有多段「::」分隔，继续替换并拆分</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">63</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">options_str</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">options_str</span><span style="--0:#F97583;--1:#BF3441">//::/</span><span style="--0:#9ECBFF;--1:#032F62">|}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">64</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">IFS</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"|"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">read</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-ra</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">opt_lines</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$options_str</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">65</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">66</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> opt_line </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">opt_lines</span><span style="--0:#9ECBFF;--1:#032F62">[</span><span style="--0:#F97583;--1:#BF3441">@</span><span style="--0:#9ECBFF;--1:#032F62">]}"</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">67</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$opt_line</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#F97583;--1:#BF3441">continue</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">68</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">69</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># opt_line 类似 "-p,--package:指定包名（必须）"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">70</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 用 ":" 分割出（短+长选项）和描述</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">71</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">IFS</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">":"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">read</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-r</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">flags</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">desc</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$opt_line</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">72</div></div><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">printf</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"  ${</span><span style="--0:#E1E4E8;--1:#24292E">GREEN</span><span style="--0:#9ECBFF;--1:#032F62">}%-20s${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} %s\n"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$flags</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$desc</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">73</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">74</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">75</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">76</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972"># 主帮助信息</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">77</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">show_help</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">78</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}使用方法:${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">79</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"  </span><span style="--0:#79B8FF;--1:#005CC5">$0</span><span style="--0:#9ECBFF;--1:#032F62"> [命令] [选项]"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">80</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">81</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}可用命令:${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">82</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> cmd </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#F97583;--1:#BF3441">!</span><span style="--0:#E1E4E8;--1:#24292E">COMMAND_MAP</span><span style="--0:#9ECBFF;--1:#032F62">[</span><span style="--0:#F97583;--1:#BF3441">@</span><span style="--0:#9ECBFF;--1:#032F62">]}"</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">83</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> desc</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">${COMMAND_MAP[$cmd]</span><span style="--0:#F97583;--1:#BF3441">%%::*</span><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">84</div></div><div class="code"><span class="indent">    </span><span style="--0:#79B8FF;--1:#005CC5">printf</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"  ${</span><span style="--0:#E1E4E8;--1:#24292E">GREEN</span><span style="--0:#9ECBFF;--1:#032F62">}%-15s${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} %s\n"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$cmd</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$desc</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">85</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">86</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-e</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"\n使用 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#79B8FF;--1:#005CC5">$0</span><span style="--0:#9ECBFF;--1:#032F62"> 命令 --help${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 查看具体命令帮助"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">87</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">88</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">89</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">##############################################</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">90</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">#               命令处理函数                 #</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">91</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">##############################################</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">92</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">93</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">handle_unzip</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">94</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">""</span><span style="--0:#E1E4E8;--1:#24292E"> output</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">""</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">95</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> [[ </span><span style="--0:#79B8FF;--1:#005CC5">$#</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">-gt</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">96</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">$1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">in</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">97</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-f</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--file</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">98</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$2</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">99</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">100</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">101</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-o</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--output</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">102</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">output</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$2</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">103</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">104</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">105</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-h</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--help</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">106</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">show_command_help</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"unzip"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">107</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">exit</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">108</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">109</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">*)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">110</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"未知选项: </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">111</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">112</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">esac</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">113</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">114</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">115</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"必须指定压缩包文件路径"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">116</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-f</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"文件不存在: </span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">117</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">118</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 如果输出目录未指定，则使用压缩包文件名作为目录名</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">119</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> [[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$output</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">then</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">120</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 去掉.md.zip后缀，获取文件名</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">121</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">output</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">$(</span><span style="--0:#B392F0;--1:#6F42C1">basename</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">.md.zip</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">122</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 创建目标目录</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">123</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">mkdir</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-p</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$CONTENT_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/</span><span style="--0:#E1E4E8;--1:#24292E">$output</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">124</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">output</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$CONTENT_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/</span><span style="--0:#E1E4E8;--1:#24292E">$output</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">125</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">126</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">mkdir</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-p</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$output</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">127</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">fi</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">128</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">129</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"正在解压 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 到 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$output</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">130</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">unzip</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-o</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-d</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$output</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">>&#x26;2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">131</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"解压完成"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">132</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">133</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 只返回解压目录路径，不输出其他信息</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">134</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">echo</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$output</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">135</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">136</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">137</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">handle_move_images</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">138</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> dir</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">""</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">139</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> [[ </span><span style="--0:#79B8FF;--1:#005CC5">$#</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">-gt</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">140</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">$1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">in</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">141</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-d</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--dir</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">142</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">dir</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$2</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">143</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">144</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">145</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-h</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--help</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">146</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">show_command_help</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"move-images"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">147</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">exit</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">148</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">149</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">*)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">150</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"未知选项: </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">151</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">152</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">esac</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">153</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">154</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">155</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"必须指定目录路径"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">156</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-d</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"目录不存在: </span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">157</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">158</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 获取子文件夹名称</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">159</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">subfolder</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">$(</span><span style="--0:#B392F0;--1:#6F42C1">basename</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">160</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">161</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 检查是否存在 assets 文件夹</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">162</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> [ </span><span style="--0:#F97583;--1:#BF3441">-d</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">dir</span><span style="--0:#9ECBFF;--1:#032F62">}/assets"</span><span style="--0:#E1E4E8;--1:#24292E"> ]; </span><span style="--0:#F97583;--1:#BF3441">then</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">163</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 创建目标文件夹（如果不存在）</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">164</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">target_dir</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$PUBLIC_IMAGES_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/</span><span style="--0:#E1E4E8;--1:#24292E">$subfolder</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">165</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">mkdir</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-p</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$target_dir</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">166</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">167</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 移动所有图片文件</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">168</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 支持的图片格式：jpg, jpeg, png, gif, webp, svg</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">169</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">find</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">dir</span><span style="--0:#9ECBFF;--1:#032F62">}/assets"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-type</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">f</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">\(</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-iname</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"*.jpg"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-o</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-iname</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"*.jpeg"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-o</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-iname</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"*.png"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-o</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-iname</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"*.gif"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-o</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-iname</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"*.webp"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-o</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-iname</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"*.svg"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">\)</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-exec</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">mv</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">{}</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$target_dir</span><span style="--0:#9ECBFF;--1:#032F62">/"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">\;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">170</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">171</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"已移动 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}${</span><span style="--0:#E1E4E8;--1:#24292E">dir</span><span style="--0:#9ECBFF;--1:#032F62">}/assets${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 中的图片到 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$target_dir</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">172</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">173</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 删除空的 assets 文件夹（可选）</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">174</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">rmdir</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">dir</span><span style="--0:#9ECBFF;--1:#032F62">}/assets"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">2></span><span style="--0:#9ECBFF;--1:#032F62">/dev/null</span><span style="--0:#E1E4E8;--1:#24292E"> &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"已删除空的 assets 文件夹"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">175</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">176</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_warning</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"目录 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 中不存在 assets 文件夹"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">177</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">fi</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">178</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">179</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">180</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">handle_update_references</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">181</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">""</span><span style="--0:#E1E4E8;--1:#24292E"> name</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">""</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">182</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> [[ </span><span style="--0:#79B8FF;--1:#005CC5">$#</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">-gt</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">183</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">$1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">in</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">184</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-f</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--file</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">185</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$2</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">186</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">187</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">188</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-n</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--name</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">189</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">name</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$2</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">190</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">191</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">192</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-h</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--help</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">193</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">show_command_help</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"update-references"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">194</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">exit</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">195</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">196</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">*)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">197</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"未知选项: </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">198</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">199</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">esac</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">200</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">201</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">202</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"必须指定MD文件路径"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">203</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-f</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"文件不存在: </span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">204</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$name</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"必须指定文件夹名称"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">205</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">206</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"正在更新 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 中的图片引用"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">207</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">208</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 步骤1: 使用 perl 将 assets/ 替换为 /images/文件夹名/</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">209</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">perl</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-i</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-pe</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">'s/(\s*)!\[(.*?)\]\(assets\//\1![\2](\/images\/'"</span><span style="--0:#E1E4E8;--1:#24292E">$name</span><span style="--0:#9ECBFF;--1:#032F62">"'\//g'</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">210</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">211</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 步骤2: 将图片路径中的空格替换为 %20</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">212</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 匹配模式：查找 ![任意文本](/images/文件夹名/任意文本)，然后处理路径部分的空格</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">213</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">perl</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-i</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-pe</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">'s/(\!\[.*?\]\()([^)]*)( )([^)]*)(\))/$1$2%20$4$5/g'</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">214</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">215</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 上面的替换可能无法处理多个空格的情况，所以我们多执行几次</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">216</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 理论上重复执行直到没有空格为止，但为了简单起见，我们重复执行几次</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">217</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">for</span><span style="--0:#E1E4E8;--1:#24292E"> i </span><span style="--0:#F97583;--1:#BF3441">in</span><span style="--0:#E1E4E8;--1:#24292E"> {</span><span style="--0:#B392F0;--1:#6F42C1">1..5}</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">218</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">perl</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-i</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-pe</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">'s/(\!\[.*?\]\()([^)]*)( )([^)]*)(\))/$1$2%20$4$5/g'</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">219</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">220</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">221</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"图片引用路径更新完成（包括空格处理）"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">222</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">223</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">224</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">handle_move_md</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">225</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">""</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">226</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> [[ </span><span style="--0:#79B8FF;--1:#005CC5">$#</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">-gt</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">227</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">$1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">in</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">228</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-f</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--file</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">229</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$2</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">230</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">231</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">232</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-h</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--help</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">233</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">show_command_help</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"move-md"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">234</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">exit</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">235</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">236</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">*)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">237</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"未知选项: </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">238</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">239</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">esac</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">240</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">241</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">242</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"必须指定MD文件路径"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">243</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-f</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"文件不存在: </span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">244</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">245</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 获取文件名和所在文件夹</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">246</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">file_name</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">$(</span><span style="--0:#B392F0;--1:#6F42C1">basename</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">247</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">folder_path</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">$(</span><span style="--0:#B392F0;--1:#6F42C1">dirname</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">248</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">folder_name</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">$(</span><span style="--0:#B392F0;--1:#6F42C1">basename</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$folder_path</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">249</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">250</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 检查目标位置是否已经存在同名文件</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">251</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> [ </span><span style="--0:#F97583;--1:#BF3441">-f</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$CONTENT_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/</span><span style="--0:#E1E4E8;--1:#24292E">$file_name</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]; </span><span style="--0:#F97583;--1:#BF3441">then</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">252</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_warning</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"根目录已存在同名文件 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file_name</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}，将重命名后移动"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">253</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 生成新文件名（添加文件夹名称作为前缀）</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">254</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">new_file_name</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">folder_name</span><span style="--0:#9ECBFF;--1:#032F62">}-${</span><span style="--0:#E1E4E8;--1:#24292E">file_name</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">255</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">mv</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$CONTENT_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/</span><span style="--0:#E1E4E8;--1:#24292E">$new_file_name</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">256</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"已将 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 移动并重命名为 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$CONTENT_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/</span><span style="--0:#E1E4E8;--1:#24292E">$new_file_name</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">257</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">258</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 移动文件到根目录</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">259</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">mv</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$CONTENT_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">260</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"已将 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 移动到 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$CONTENT_PATH</span><span style="--0:#9ECBFF;--1:#032F62">/</span><span style="--0:#E1E4E8;--1:#24292E">$file_name</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">261</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">fi</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">262</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">263</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 检查子文件夹是否为空</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">264</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> [ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"$(</span><span style="--0:#B392F0;--1:#6F42C1">ls</span><span style="--0:#9ECBFF;--1:#032F62"> </span><span style="--0:#79B8FF;--1:#005CC5">-A</span><span style="--0:#9ECBFF;--1:#032F62"> "</span><span style="--0:#E1E4E8;--1:#24292E">$folder_path</span><span style="--0:#9ECBFF;--1:#032F62">" </span><span style="--0:#F97583;--1:#BF3441">2></span><span style="--0:#9ECBFF;--1:#032F62">/dev/null)"</span><span style="--0:#E1E4E8;--1:#24292E"> ]; </span><span style="--0:#F97583;--1:#BF3441">then</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">265</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 文件夹为空，可以删除</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">266</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">rmdir</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$folder_path</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">267</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"已删除空文件夹 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$folder_path</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">268</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">269</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"文件夹 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$folder_path</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 不为空，保留"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">270</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">fi</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">271</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">272</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">273</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">handle_process_all</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">274</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">""</span><span style="--0:#E1E4E8;--1:#24292E"> delete_zip</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">275</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> [[ </span><span style="--0:#79B8FF;--1:#005CC5">$#</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">-gt</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">276</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">case</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#FFAB70;--1:#AE4B07">$1</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">in</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">277</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-f</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--file</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">278</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">file</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$2</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">279</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">2</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">280</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">281</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-d</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--delete</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">282</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">delete_zip</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">1</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">283</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">shift</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">284</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">285</div></div><div class="code"><span class="indent">      </span><span style="--0:#DBEDFF;--1:#032F62">-h</span><span style="--0:#F97583;--1:#BF3441">|</span><span style="--0:#DBEDFF;--1:#032F62">--help</span><span style="--0:#F97583;--1:#BF3441">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">286</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">show_command_help</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"process-all"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">287</div></div><div class="code"><span class="indent">        </span><span style="--0:#79B8FF;--1:#005CC5">exit</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">288</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">289</div></div><div class="code"><span class="indent">      </span><span style="--0:#F97583;--1:#BF3441">*)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">290</div></div><div class="code"><span class="indent">        </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"未知选项: </span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">291</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">        </span></span><span style="--0:#E1E4E8;--1:#24292E">;;</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">292</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">esac</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">293</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">294</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">295</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-z</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"必须指定压缩包文件路径"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">296</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-f</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"文件不存在: </span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">297</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">298</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"开始处理文件 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">299</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">300</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 1. 解压文件 - 捕获返回的目录路径而不是所有输出</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">301</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">dir</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">$(</span><span style="--0:#B392F0;--1:#6F42C1">handle_unzip</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">--file</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">302</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"文件已解压到 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">303</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">304</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 获取文件夹名称</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">305</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">folder_name</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E">$(</span><span style="--0:#B392F0;--1:#6F42C1">basename</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">306</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">307</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 2. 移动图片</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">308</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">handle_move_images</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">--dir</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">309</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"图片已移动到公共目录"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">310</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">311</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 3. 查找MD文件 - 使用更安全的方式处理包含空格的文件名</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">312</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 不使用命令替换和for循环，而是使用 while read 循环</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">313</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"搜索MD文件..."</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">314</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> found_files</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">315</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">316</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">while</span><span style="--0:#E1E4E8;--1:#24292E"> IFS</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">read</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-r</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-d</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">''</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">md_file</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">do</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">317</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 4. 更新图片引用</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">318</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">    </span></span><span style="--0:#E1E4E8;--1:#24292E">found_files</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">1</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">319</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"找到MD文件: ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$md_file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">320</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">handle_update_references</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">--file</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$md_file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">--name</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$folder_name</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">321</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"MD文件中的图片引用已更新"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">322</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">323</div></div><div class="code"><span class="indent">    </span><span style="--0:#99A0A6;--1:#616972"># 5. 移动MD文件</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">324</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">handle_move_md</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">--file</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$md_file</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">325</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_info</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"MD文件已移动到博客根目录"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">326</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">done</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">&#x3C;(</span><span style="--0:#B392F0;--1:#6F42C1">find</span><span style="--0:#9ECBFF;--1:#032F62"> "</span><span style="--0:#E1E4E8;--1:#24292E">$dir</span><span style="--0:#9ECBFF;--1:#032F62">" </span><span style="--0:#79B8FF;--1:#005CC5">-maxdepth</span><span style="--0:#9ECBFF;--1:#032F62"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#9ECBFF;--1:#032F62"> </span><span style="--0:#79B8FF;--1:#005CC5">-type</span><span style="--0:#9ECBFF;--1:#032F62"> f </span><span style="--0:#79B8FF;--1:#005CC5">-name</span><span style="--0:#9ECBFF;--1:#032F62"> "*.md" </span><span style="--0:#79B8FF;--1:#005CC5">-print0</span><span style="--0:#9ECBFF;--1:#032F62">)</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">327</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">328</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> [[ $found_files </span><span style="--0:#F97583;--1:#BF3441">-eq</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">then</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">329</div></div><div class="code"><span class="indent">    </span><span style="--0:#B392F0;--1:#6F42C1">log_warning</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"未找到MD文件"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">330</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">fi</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">331</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">332</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 6. 删除源压缩包（如果选择了--delete选项）</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">333</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> [[ $delete_zip </span><span style="--0:#F97583;--1:#BF3441">-eq</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">1</span><span style="--0:#E1E4E8;--1:#24292E"> ]]; </span><span style="--0:#F97583;--1:#BF3441">then</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">334</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">if</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">rm</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">; </span><span style="--0:#F97583;--1:#BF3441">then</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">335</div></div><div class="code"><span class="indent">      </span><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"已删除源压缩包 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">336</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">else</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">337</div></div><div class="code"><span class="indent">      </span><span style="--0:#B392F0;--1:#6F42C1">log_warning</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"删除源压缩包 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 失败"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">338</div></div><div class="code"><span class="indent">    </span><span style="--0:#F97583;--1:#BF3441">fi</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">339</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">fi</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">340</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">341</div></div><div class="code"><span class="indent">  </span><span style="--0:#B392F0;--1:#6F42C1">log_success</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"文件 ${</span><span style="--0:#E1E4E8;--1:#24292E">YELLOW</span><span style="--0:#9ECBFF;--1:#032F62">}</span><span style="--0:#E1E4E8;--1:#24292E">$file</span><span style="--0:#9ECBFF;--1:#032F62">${</span><span style="--0:#E1E4E8;--1:#24292E">NC</span><span style="--0:#9ECBFF;--1:#032F62">} 处理完成"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">342</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">343</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">344</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">##############################################</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">345</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">#                 主逻辑                     #</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">346</div></div><div class="code"><span style="--0:#99A0A6;--1:#616972">##############################################</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">347</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">348</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">main</span><span style="--0:#E1E4E8;--1:#24292E">() {</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">349</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#79B8FF;--1:#005CC5">$#</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">-eq</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span><span style="--0:#E1E4E8;--1:#24292E"> ]] </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> [[ </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">==</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"--help"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] &#x26;&#x26; </span><span style="--0:#B392F0;--1:#6F42C1">show_help</span><span style="--0:#E1E4E8;--1:#24292E"> &#x26;&#x26; </span><span style="--0:#79B8FF;--1:#005CC5">exit</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">0</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">350</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">351</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> cmd</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$1</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">352</div></div><div class="code"><span class="indent">  </span><span style="--0:#79B8FF;--1:#005CC5">shift</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">353</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">354</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">[[ </span><span style="--0:#F97583;--1:#BF3441">-n</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">COMMAND_MAP</span><span style="--0:#9ECBFF;--1:#032F62">[</span><span style="--0:#E1E4E8;--1:#24292E">$cmd</span><span style="--0:#9ECBFF;--1:#032F62">]}"</span><span style="--0:#E1E4E8;--1:#24292E"> ]] </span><span style="--0:#F97583;--1:#BF3441">||</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#B392F0;--1:#6F42C1">panic</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"未知命令: </span><span style="--0:#E1E4E8;--1:#24292E">$cmd</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">355</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">356</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 同样地，这里也要避免直接 IFS="::" 分割</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">357</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 先用 '|' 替换 "::" ，再做一次分割即可</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">358</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> info</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">COMMAND_MAP</span><span style="--0:#9ECBFF;--1:#032F62">[</span><span style="--0:#E1E4E8;--1:#24292E">$cmd</span><span style="--0:#9ECBFF;--1:#032F62">]}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">359</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">info</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"${</span><span style="--0:#E1E4E8;--1:#24292E">info</span><span style="--0:#F97583;--1:#BF3441">//::/</span><span style="--0:#9ECBFF;--1:#032F62">|}"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">360</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">361</div></div><div class="code"><span class="indent">  </span><span style="--0:#F97583;--1:#BF3441">local</span><span style="--0:#E1E4E8;--1:#24292E"> desc handler options_str</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">362</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">IFS</span><span style="--0:#F97583;--1:#BF3441">=</span><span style="--0:#9ECBFF;--1:#032F62">"|"</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">read</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-r</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">desc</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">handler</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">options_str</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#F97583;--1:#BF3441">&#x3C;&#x3C;&#x3C;</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#E1E4E8;--1:#24292E">$info</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">363</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">364</div></div><div class="code"><span class="indent">  </span><span style="--0:#99A0A6;--1:#616972"># 调用对应的处理函数</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">365</div></div><div class="code"><span class="indent"><span style="--0:#E1E4E8;--1:#24292E">  </span></span><span style="--0:#E1E4E8;--1:#24292E">$handler </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$@</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">366</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">}</span></div></div><div class="ec-line"><div class="gutter"><div class="ln">367</div></div><div class="code">
</div></div><div class="ec-line"><div class="gutter"><div class="ln">368</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">main</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"</span><span style="--0:#79B8FF;--1:#005CC5">$@</span><span style="--0:#9ECBFF;--1:#032F62">"</span></div></div></details></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="#!/usr/bin/env bashset -eo pipefail# 颜色配置RED=&#x27;\033[0;31m&#x27;GREEN=&#x27;\033[0;32m&#x27;YELLOW=&#x27;\033[1;33m&#x27;NC=&#x27;\033[0m&#x27;# 基础路径配置BLOG_PATH=&#x22;/home/ling/Desktop/blog/astro-yi&#x22;CONTENT_PATH=&#x22;$BLOG_PATH/src/content/blog&#x22;PUBLIC_IMAGES_PATH=&#x22;$BLOG_PATH/public/images&#x22;# 命令配置：格式「命令名=&#x22;描述::处理函数::选项声明&#x22;」declare -A COMMAND_MAP=(  [&#x22;unzip&#x22;]=&#x22;解压思源笔记导出的md压缩包::handle_unzip::-f,--file:指定压缩包文件路径（必须）::-o,--output:输出目录（默认：与压缩包同名）&#x22;  [&#x22;move-images&#x22;]=&#x22;移动图片文件到公共目录::handle_move_images::-d,--dir:指定包含assets的目录（必须）&#x22;  [&#x22;update-references&#x22;]=&#x22;更新MD文件中的图片引用::handle_update_references::-f,--file:指定MD文件路径（必须）::-n,--name:文件夹名称（必须）&#x22;  [&#x22;move-md&#x22;]=&#x22;移动MD文件到博客根目录::handle_move_md::-f,--file:指定MD文件路径（必须）&#x22;  [&#x22;process-all&#x22;]=&#x22;执行完整处理流程::handle_process_all::-f,--file:指定压缩包文件路径（必须）::-d,--delete:处理完成后删除源压缩包（可选）&#x22;)# 错误处理函数panic() {  echo -e &#x22;${RED}[错误]${NC} $1&#x22; >&#x26;2  exit 1}# 日志输出函数log_info() {  echo -e &#x22;${GREEN}[信息]${NC} $1&#x22; >&#x26;2}log_warning() {  echo -e &#x22;${YELLOW}[警告]${NC} $1&#x22; >&#x26;2}log_success() {  echo -e &#x22;${GREEN}[成功]${NC} $1&#x22; >&#x26;2}###############################################          通用的帮助信息生成函数            ###############################################show_command_help() {  local cmd=&#x22;$1&#x22;  local info=&#x22;${COMMAND_MAP[$cmd]}&#x22;  # 1) 把所有 &#x22;::&#x22; 替换成一个不会在脚本中出现的分隔符，比如 &#x27;|&#x27;  info=&#x22;${info//::/|}&#x22;  # 2) 这时才能安全地用 IFS=&#x27;|&#x27; 来做分割  local desc handler options_str  IFS=&#x22;|&#x22; read -r desc handler options_str <<< &#x22;$info&#x22;  echo -e &#x22;${YELLOW}命令: ${GREEN}$cmd${NC}&#x22;  echo -e &#x22;${YELLOW}描述: ${NC}$desc&#x22;  echo -e &#x22;${YELLOW}选项:${NC}&#x22;  # 3) 选项声明里可能有多段「::」分隔，继续替换并拆分  options_str=&#x22;${options_str//::/|}&#x22;  IFS=&#x22;|&#x22; read -ra opt_lines <<< &#x22;$options_str&#x22;  for opt_line in &#x22;${opt_lines[@]}&#x22;; do    [[ -z &#x22;$opt_line&#x22; ]] &#x26;&#x26; continue    # opt_line 类似 &#x22;-p,--package:指定包名（必须）&#x22;    # 用 &#x22;:&#x22; 分割出（短+长选项）和描述    IFS=&#x22;:&#x22; read -r flags desc <<< &#x22;$opt_line&#x22;    printf &#x22;  ${GREEN}%-20s${NC} %s\n&#x22; &#x22;$flags&#x22; &#x22;$desc&#x22;  done}# 主帮助信息show_help() {  echo -e &#x22;${YELLOW}使用方法:${NC}&#x22;  echo &#x22;  $0 [命令] [选项]&#x22;  echo  echo -e &#x22;${YELLOW}可用命令:${NC}&#x22;  for cmd in &#x22;${!COMMAND_MAP[@]}&#x22;; do    local desc=${COMMAND_MAP[$cmd]%%::*}    printf &#x22;  ${GREEN}%-15s${NC} %s\n&#x22; &#x22;$cmd&#x22; &#x22;$desc&#x22;  done  echo -e &#x22;\n使用 ${YELLOW}$0 命令 --help${NC} 查看具体命令帮助&#x22;}###############################################               命令处理函数                 ###############################################handle_unzip() {  local file=&#x22;&#x22; output=&#x22;&#x22;  while [[ $# -gt 0 ]]; do    case $1 in      -f|--file)        file=&#x22;$2&#x22;        shift 2        ;;      -o|--output)        output=&#x22;$2&#x22;        shift 2        ;;      -h|--help)        show_command_help &#x22;unzip&#x22;        exit 0        ;;      *)        panic &#x22;未知选项: $1&#x22;        ;;    esac  done  [[ -z &#x22;$file&#x22; ]] &#x26;&#x26; panic &#x22;必须指定压缩包文件路径&#x22;  [[ -f &#x22;$file&#x22; ]] || panic &#x22;文件不存在: $file&#x22;  # 如果输出目录未指定，则使用压缩包文件名作为目录名  if [[ -z &#x22;$output&#x22; ]]; then    # 去掉.md.zip后缀，获取文件名    output=$(basename &#x22;$file&#x22; .md.zip)    # 创建目标目录    mkdir -p &#x22;$CONTENT_PATH/$output&#x22;    output=&#x22;$CONTENT_PATH/$output&#x22;  else    mkdir -p &#x22;$output&#x22;  fi  log_info &#x22;正在解压 ${YELLOW}$file${NC} 到 ${YELLOW}$output${NC}&#x22;  unzip -o &#x22;$file&#x22; -d &#x22;$output&#x22; >&#x26;2  log_success &#x22;解压完成&#x22;  # 只返回解压目录路径，不输出其他信息  echo &#x22;$output&#x22;}handle_move_images() {  local dir=&#x22;&#x22;  while [[ $# -gt 0 ]]; do    case $1 in      -d|--dir)        dir=&#x22;$2&#x22;        shift 2        ;;      -h|--help)        show_command_help &#x22;move-images&#x22;        exit 0        ;;      *)        panic &#x22;未知选项: $1&#x22;        ;;    esac  done  [[ -z &#x22;$dir&#x22; ]] &#x26;&#x26; panic &#x22;必须指定目录路径&#x22;  [[ -d &#x22;$dir&#x22; ]] || panic &#x22;目录不存在: $dir&#x22;  # 获取子文件夹名称  subfolder=$(basename &#x22;$dir&#x22;)  # 检查是否存在 assets 文件夹  if [ -d &#x22;${dir}/assets&#x22; ]; then    # 创建目标文件夹（如果不存在）    target_dir=&#x22;$PUBLIC_IMAGES_PATH/$subfolder&#x22;    mkdir -p &#x22;$target_dir&#x22;    # 移动所有图片文件    # 支持的图片格式：jpg, jpeg, png, gif, webp, svg    find &#x22;${dir}/assets&#x22; -type f \( -iname &#x22;*.jpg&#x22; -o -iname &#x22;*.jpeg&#x22; -o -iname &#x22;*.png&#x22; -o -iname &#x22;*.gif&#x22; -o -iname &#x22;*.webp&#x22; -o -iname &#x22;*.svg&#x22; \) -exec mv {} &#x22;$target_dir/&#x22; \;    log_success &#x22;已移动 ${YELLOW}${dir}/assets${NC} 中的图片到 ${YELLOW}$target_dir${NC}&#x22;    # 删除空的 assets 文件夹（可选）    rmdir &#x22;${dir}/assets&#x22; 2>/dev/null &#x26;&#x26; log_info &#x22;已删除空的 assets 文件夹&#x22;  else    log_warning &#x22;目录 ${YELLOW}$dir${NC} 中不存在 assets 文件夹&#x22;  fi}handle_update_references() {  local file=&#x22;&#x22; name=&#x22;&#x22;  while [[ $# -gt 0 ]]; do    case $1 in      -f|--file)        file=&#x22;$2&#x22;        shift 2        ;;      -n|--name)        name=&#x22;$2&#x22;        shift 2        ;;      -h|--help)        show_command_help &#x22;update-references&#x22;        exit 0        ;;      *)        panic &#x22;未知选项: $1&#x22;        ;;    esac  done  [[ -z &#x22;$file&#x22; ]] &#x26;&#x26; panic &#x22;必须指定MD文件路径&#x22;  [[ -f &#x22;$file&#x22; ]] || panic &#x22;文件不存在: $file&#x22;  [[ -z &#x22;$name&#x22; ]] &#x26;&#x26; panic &#x22;必须指定文件夹名称&#x22;  log_info &#x22;正在更新 ${YELLOW}$file${NC} 中的图片引用&#x22;  # 步骤1: 使用 perl 将 assets/ 替换为 /images/文件夹名/  perl -i -pe &#x27;s/(\s*)!\[(.*?)\]\(assets\//\1![\2](\/images\/&#x27;&#x22;$name&#x22;&#x27;\//g&#x27; &#x22;$file&#x22;  # 步骤2: 将图片路径中的空格替换为 %20  # 匹配模式：查找 ![任意文本](/images/文件夹名/任意文本)，然后处理路径部分的空格  perl -i -pe &#x27;s/(\!\[.*?\]\()([^)]*)( )([^)]*)(\))/$1$2%20$4$5/g&#x27; &#x22;$file&#x22;  # 上面的替换可能无法处理多个空格的情况，所以我们多执行几次  # 理论上重复执行直到没有空格为止，但为了简单起见，我们重复执行几次  for i in {1..5}; do    perl -i -pe &#x27;s/(\!\[.*?\]\()([^)]*)( )([^)]*)(\))/$1$2%20$4$5/g&#x27; &#x22;$file&#x22;  done  log_success &#x22;图片引用路径更新完成（包括空格处理）&#x22;}handle_move_md() {  local file=&#x22;&#x22;  while [[ $# -gt 0 ]]; do    case $1 in      -f|--file)        file=&#x22;$2&#x22;        shift 2        ;;      -h|--help)        show_command_help &#x22;move-md&#x22;        exit 0        ;;      *)        panic &#x22;未知选项: $1&#x22;        ;;    esac  done  [[ -z &#x22;$file&#x22; ]] &#x26;&#x26; panic &#x22;必须指定MD文件路径&#x22;  [[ -f &#x22;$file&#x22; ]] || panic &#x22;文件不存在: $file&#x22;  # 获取文件名和所在文件夹  file_name=$(basename &#x22;$file&#x22;)  folder_path=$(dirname &#x22;$file&#x22;)  folder_name=$(basename &#x22;$folder_path&#x22;)  # 检查目标位置是否已经存在同名文件  if [ -f &#x22;$CONTENT_PATH/$file_name&#x22; ]; then    log_warning &#x22;根目录已存在同名文件 ${YELLOW}$file_name${NC}，将重命名后移动&#x22;    # 生成新文件名（添加文件夹名称作为前缀）    new_file_name=&#x22;${folder_name}-${file_name}&#x22;    mv &#x22;$file&#x22; &#x22;$CONTENT_PATH/$new_file_name&#x22;    log_success &#x22;已将 ${YELLOW}$file${NC} 移动并重命名为 ${YELLOW}$CONTENT_PATH/$new_file_name${NC}&#x22;  else    # 移动文件到根目录    mv &#x22;$file&#x22; &#x22;$CONTENT_PATH/&#x22;    log_success &#x22;已将 ${YELLOW}$file${NC} 移动到 ${YELLOW}$CONTENT_PATH/$file_name${NC}&#x22;  fi  # 检查子文件夹是否为空  if [ -z &#x22;$(ls -A &#x22;$folder_path&#x22; 2>/dev/null)&#x22; ]; then    # 文件夹为空，可以删除    rmdir &#x22;$folder_path&#x22;    log_info &#x22;已删除空文件夹 ${YELLOW}$folder_path${NC}&#x22;  else    log_info &#x22;文件夹 ${YELLOW}$folder_path${NC} 不为空，保留&#x22;  fi}handle_process_all() {  local file=&#x22;&#x22; delete_zip=0  while [[ $# -gt 0 ]]; do    case $1 in      -f|--file)        file=&#x22;$2&#x22;        shift 2        ;;      -d|--delete)        delete_zip=1        shift        ;;      -h|--help)        show_command_help &#x22;process-all&#x22;        exit 0        ;;      *)        panic &#x22;未知选项: $1&#x22;        ;;    esac  done  [[ -z &#x22;$file&#x22; ]] &#x26;&#x26; panic &#x22;必须指定压缩包文件路径&#x22;  [[ -f &#x22;$file&#x22; ]] || panic &#x22;文件不存在: $file&#x22;  log_info &#x22;开始处理文件 ${YELLOW}$file${NC}&#x22;  # 1. 解压文件 - 捕获返回的目录路径而不是所有输出  dir=$(handle_unzip --file &#x22;$file&#x22;)  log_info &#x22;文件已解压到 ${YELLOW}$dir${NC}&#x22;  # 获取文件夹名称  folder_name=$(basename &#x22;$dir&#x22;)  # 2. 移动图片  handle_move_images --dir &#x22;$dir&#x22;  log_info &#x22;图片已移动到公共目录&#x22;  # 3. 查找MD文件 - 使用更安全的方式处理包含空格的文件名  # 不使用命令替换和for循环，而是使用 while read 循环  log_info &#x22;搜索MD文件...&#x22;  local found_files=0  while IFS= read -r -d &#x27;&#x27; md_file; do    # 4. 更新图片引用    found_files=1    log_info &#x22;找到MD文件: ${YELLOW}$md_file${NC}&#x22;    handle_update_references --file &#x22;$md_file&#x22; --name &#x22;$folder_name&#x22;    log_info &#x22;MD文件中的图片引用已更新&#x22;    # 5. 移动MD文件    handle_move_md --file &#x22;$md_file&#x22;    log_info &#x22;MD文件已移动到博客根目录&#x22;  done < <(find &#x22;$dir&#x22; -maxdepth 1 -type f -name &#x22;*.md&#x22; -print0)  if [[ $found_files -eq 0 ]]; then    log_warning &#x22;未找到MD文件&#x22;  fi  # 6. 删除源压缩包（如果选择了--delete选项）  if [[ $delete_zip -eq 1 ]]; then    if rm &#x22;$file&#x22;; then      log_success &#x22;已删除源压缩包 ${YELLOW}$file${NC}&#x22;    else      log_warning &#x22;删除源压缩包 ${YELLOW}$file${NC} 失败&#x22;    fi  fi  log_success &#x22;文件 ${YELLOW}$file${NC} 处理完成&#x22;}###############################################                 主逻辑                     ###############################################main() {  [[ $# -eq 0 ]] || [[ &#x22;$1&#x22; == &#x22;--help&#x22; ]] &#x26;&#x26; show_help &#x26;&#x26; exit 0  local cmd=&#x22;$1&#x22;  shift  [[ -n &#x22;${COMMAND_MAP[$cmd]}&#x22; ]] || panic &#x22;未知命令: $cmd&#x22;  # 同样地，这里也要避免直接 IFS=&#x22;::&#x22; 分割  # 先用 &#x27;|&#x27; 替换 &#x22;::&#x22; ，再做一次分割即可  local info=&#x22;${COMMAND_MAP[$cmd]}&#x22;  info=&#x22;${info//::/|}&#x22;  local desc handler options_str  IFS=&#x22;|&#x22; read -r desc handler options_str <<< &#x22;$info&#x22;  # 调用对应的处理函数  $handler &#x22;$@&#x22;}main &#x22;$@&#x22;"><div></div></button></div></figure></div>
<p>　　脚本将每一个功能都独立为一个命令选项，并提供整合选项 <code>process-all</code>​ 自动执行所有功能。</p>
<p>　　例如</p>
<div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#B392F0;--1:#6F42C1">./siyuan_export_processor.sh</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">process-all</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-d</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#79B8FF;--1:#005CC5">-f</span><span style="--0:#E1E4E8;--1:#24292E"> </span><span style="--0:#9ECBFF;--1:#032F62">"年轻人的第一台 VPS 代理服务器.md.zip"</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="./siyuan_export_processor.sh process-all -d -f &#x22;年轻人的第一台 VPS 代理服务器.md.zip&#x22;"><div></div></button></div></figure></div>
<p>​<img src="/spinner.gif" alt="default" data-src="/images/Astro%20%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%83%A8%E7%BD%B2/image-20250227145619-kr35n2m.png" data-alt="image">​</p>
<h3 id="调整-frontmatter">调整 frontmatter</h3>
<p>　　Astro 主题有一些额外的 frontmatter，思源默认的 frontmatter 可能没有这么多。需要手动调整一下，比如 分类和标签。</p>
<h3 id="vscode-编写">VSCODE 编写</h3>
<p>　　除了思源笔记以外，还可以通过 vscode 编写，虽然目前 vscode 已经自带了 markdown 的图片粘贴自动引用，但在 cursor 里没法用。需要安装扩展 Markdown Paste。</p>
<p>　　可以在设置中的 <code>Markdown Paste: Path</code>​ 中修改自定义存放目录。例如在 Astro 的通常的文件结构中，存放在 /public/images 中。</p>
<div class="expressive-code"><figure class="frame is-terminal"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><div class="gutter"><div class="ln">1</div></div><div class="code"><span style="--0:#E1E4E8;--1:#24292E">${workspaceFolder}/public/images/${fileBasenameNoExtension}/</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="${workspaceFolder}/public/images/${fileBasenameNoExtension}/"><div></div></button></div></figure></div>
<p>　　直接使用 vscode 编写 md 文件，可以更好的利用主题提供的额外的 markdown 语法。</p>
<h3 id="git-提交">git 提交</h3>
<p>　　写完后，用 git 工具提交到仓库，会自动触发编译，并推动到公开仓库部署。</p> </article> <div class="divider-horizontal"></div> <div class="h-8 text-skin-base"> <a class="truncate  w-auto max-w-[40%] float-left" href="/blog/docker/docker-容器移动后用户权限问题" title="Docker 容器移动后用户权限问题"> <i class="ri-arrow-left-s-fill"></i> Docker 容器移动后用户权限问题 </a> <div class="flex item-center float-right w-auto max-w-[40%] text-right"> <a class="truncate " href="/blog/proxy/年轻人的第一台vpsreality-节点搭建" title="年轻人的第一台VPS：Reality 节点搭建"> 年轻人的第一台VPS：Reality 节点搭建 </a> <i class="ri-arrow-right-s-fill float-right"></i> </div> </div> <div class="border-l-4 my-4 p-4 border-l-skin-base bg-skin-card break-all"> <div>本文标题：Astro 博客搭建与部署</div> <div>文章作者：Lyndra</div> <div>发布时间：2025-01-14</div> <div> 原始链接：<a href="https://www.hysling.top/blog/astro-博客搭建与部署" class="hover:text-skin-active">https://www.hysling.top/blog/astro-博客搭建与部署</a> </div> </div>  </div>  <div class="giscus"></div> <script src="https://giscus.app/client.js" data-repo="codetang-2417/codetang-2417.github.io" data-repo-id="R_kgDOMyu4sg" data-category="Announcements" data-category-id="DIC_kwDOMyu4ss4CiiW6" data-mapping="title" data-strict="light" data-reactions-enabled="dark" data-emit-metadata="1" data-input-position="0" data-theme="light" data-lang="zh-CN" crossorigin="anonymous"></script> </div> <div class="hidden xl:block col-span-1 relative"> <div class="shadow-lg rounded-lg h-64 w-auto flex flex-col items-center justify-center bg-skin-card p-2"> <img class="avatar mb-4" src="/avatar.svg" alt="avatar"> <div class="mb-2 text-center">本来无一物，何处惹尘埃</div> <div class="flex items-center justify-center flex-wrap"> <a title="github" href="https://github.com/codetang-2417" target="_blank"> <i class="ri-github-fill text-2xl mr-2 cursor-pointer"></i> </a><a title="rss" href target="_blank"> <i class="ri-rss-fill text-2xl mr-2 cursor-pointer"></i> </a> </div> </div> <div id="toc" class="shadow-lg rounded-lg my-4 py-2 px-2 bg-skin-card sticky top-20" data-astro-cid-6t6zfk7k> <div class="aside-widget" data-astro-cid-6t6zfk7k> <i class="ri-list-check menu-icon" data-astro-cid-6t6zfk7k></i> 文章目录 </div> <div class="overflow-auto" data-astro-cid-6t6zfk7k> <div class="toc-container" data-astro-cid-6t6zfk7k></div> </div> </div>  <script type="module" src="/_astro/Toc.astro_astro_type_script_index_0_lang.R6DO86cs.js"></script> </div> <button type="button" id="scrollToTopBtn" class="header-btn fixed bottom-4 right-2 hidden" title="scroll to top"> <i class="ri-arrow-up-line"></i> </button> <script type="module">let o=document.getElementById("scrollToTopBtn");window.addEventListener("scroll",function(){window.scrollY>200?o.style.display="block":o.style.display="none"});o.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})});</script> </div> <div class="h-16 container p-1 absolute left-0 bottom-0"> <div class="flex items-center justify-center text-skin-base"> <span id="busuanzi_container_site_pv"> 总访问量<span id="busuanzi_value_site_pv"></span>次 </span> <div class="divider-vertical"></div> <span id="busuanzi_container_site_uv"> 总访客数<span id="busuanzi_value_site_uv"></span>人次 </span> </div> <div class="flex items-center flex-col flex-wrap justify-center mb-4 text-skin-base first:mb-0 sm:flex-row"> <div> <span class="cursor-default">Copyright</span> <i class="ri-copyright-line align-middle"></i> <span class="align-middle">2025</span> </div>  <div class="divider-vertical"></div> <a href="/sitemap-0.xml">站点地图</a> </div> </div> </main> <script type="module" src="/_astro/BlogPost.astro_astro_type_script_index_0_lang.C_bBgou1.js"></script></body></html>